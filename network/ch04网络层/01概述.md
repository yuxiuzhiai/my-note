## 网络层功能

* 转发。将分组从一个输入链路接口转移到适当的输出链路接口的路由器本地动作。转发发生的时间尺度很短，通常用硬件来实现
* 路由选择。确定分组从源到目的地所采取的端到端路径的网络范围处理过程。路由选择发生的时间尺度要长的多，因此通常用软件来实现

## 路由器工作原理

路由器的四个组件

* 输入端口。
* 交换结构
* 输出端口
* 路由选择处理器

### 输入端口

### 交换

交换可以有许多方式实现：

* 内存
* 纵横式
* 总线

### 输出端口

## IP协议

### IPv4数据报格式

关键字段：

* 版本。4比特，规定了IP协议版本
* 首部长度。4比特。因为IPv4数据包可包含一些可变数量的选项，所以需要用4比特来确定IP数据报中载荷实际开始的地方
* 服务类型。8比特，用于使不同类型的IP数据报能互相区别开来
* 数据报长度(字节)。16比特。IP数据报的总长度（首部加数据）。因为该字段长为16比特，所以IP数据报的理论最大长度为65535字节
* 标识、标志、片偏移。与所谓IP分片有关
* ttl。8比特。用来确保数据报不会永远在网络中循环。每当一台路由器处理数据报时，改字段的值减1.若值减为0，则数据报被丢弃
* 上层协议。8比特。标识IP数据报的数据部分应交给哪个特定的运输层协议。
* 首部校验和。16比特
* 源IP地址。32比特
* 目的IP地址。32比特
* 选项
* 数据

### IPv4数据报分片

一个链路层帧所能承载的最大数据量叫做最大传送单元Maximum Transmission Unit，MTU。并不是所有的链路层协议都能承载相同长度的网络层分组。因此，如果一个IP数据报所经历的链路层协议不一样时，就可能出现有的链路层协议不能支持当前IP数据报的大小，从而需要将IP数据报分片

### IPv4编址

#### DHCP协议



